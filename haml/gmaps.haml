- api_key = 'ABQIAAAAd7pNuaDUM-lL38n-vArNXBR0ZRp1JZh4h7CKr3-jCVpVBLMvyhSTGDL-jXAAe5G2ohVl5qRFqZ-Nqw'
/ !!!
%html
  %title Google Maps test
  %style
    :sass
      #map
        :clear both
        :width 100%
        :height 90%
      #search
        :float right
  %script{:type=>'text/javascript', :src => "http://maps.google.com/maps?file=api&amp;v=2.x&amp;key=#{api_key}"}
  :javascript
    var map = null;
    var geocoder = null;

    function initialize() {
      if (GBrowserIsCompatible()) {
        map = new GMap2(document.getElementById("map"));
        map.setCenter(new GLatLng(52.4419, 5.1419), 3);
        geocoder = new GClientGeocoder();
      }
    }

    function showAddress(address) {
      if (geocoder) {
        geocoder.getLatLng(
          address,
          function(point) {
            if (!point) {
              alert(address + " not found");
            } else {
              map.setCenter(point, 8);
              var marker = new GMarker(point);
              map.addOverlay(marker);
              marker.openInfoWindowHtml(address);
            }
          }
        );
      }
    }
  %body{:onload=>'initialize()'}
    %form{:action=>"#", :onsubmit=>'showAddress(this.address.value); return false', :id=>'search'}
      %input{:type=>'text', :name=>'address'}
      %input{:type=>'submit', :value=>'Search'}
    #map
